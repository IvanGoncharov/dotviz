<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>dotviz demo</title>
  <style>
    body { font-family: sans-serif; padding: 1em; }
    #output { margin-top: 1em; border: 1px solid #ccc; padding: 1em; }
  </style>
</head>
<body>
  <h1>dotviz</h1>

  <textarea id="test"></textarea>

  {{{ SCRIPT }}}

  <script>
    const graph = {
      graphAttributes: { rankdir: "LR" },
      nodeAttributes: { shape: "circle" },
      nodes: [
        { name: "a", attributes: { label: { html: "&lt;i&gt;A&lt;/i&gt;" }, color: "red" } },
        { name: "b", attributes: { label: { html: "&lt;b&gt;A&lt;/b&gt;" }, color: "green" } }
      ],
      edges: [
        { tail: "a", head: "b", attributes: { label: "1" } },
        { tail: "b", head: "c", attributes: { label: "2", headport: "name" } }
      ],
      subgraphs: [
        {
          name: "cluster_1",
          nodes: [
            {
              name: "c",
              attributes: {
                label: {
                  html: "&lt;table&gt;&lt;tr&gt;&lt;td&gt;test&lt;/td&gt;&lt;td port=\"name\"&gt;C&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;"
                }
              }
            }
          ]
        }
      ]
    };

    Module = {}

    Module['onRuntimeInitialized'] = function() {
      const str_ptr = Module.stringToNewUTF8(JSON.stringify(graph))
      const res_ptr = Module._viz_parse_json_to_svg(str_ptr)
      const res = Module.UTF8ToString(res_ptr)
      document.getElementById("test").textContent = "From wasm: "+res
      Module._free(str_ptr)
      Module._free(res_ptr)
    }
  </script>
</body>
</html>
